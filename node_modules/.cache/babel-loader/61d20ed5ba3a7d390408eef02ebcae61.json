{"ast":null,"code":"var _jsxFileName = \"/Users/tkak/sample/react2/my-app/src/components/sort.js\";\nimport React, { useState, useMemo } from 'react';\nimport Movie from './movie';\nimport Button from './button';\nimport Filter from './filter';\nimport Select from './select';\nimport logo from '../images/logo.png';\nimport arrow from '../images/arrow.png';\n\nconst Sort = props => {\n  const [sort, setSort] = useState([]);\n  const [filterQuery, setFilterQuery] = useState({});\n  const [year, setYear] = useState([2019]);\n  const sortedMovies = useMemo(() => {\n    let _sortedMovies = props.movies[year][\"movies\"]; //入力した文字は小文字にする\n\n    const filterTitle = filterQuery.title && filterQuery.title.toLowerCase(); //絞り込み検索\n\n    _sortedMovies = _sortedMovies.filter(row => {\n      //タイトルで絞り込み\n      if (filterQuery.title && String(row.title).toLowerCase().indexOf(filterTitle) === -1) {\n        return false;\n      }\n\n      return row;\n    }); //ソート\n\n    if (sort.key) {\n      _sortedMovies = _sortedMovies.sort((a, b) => {\n        a = a[sort.key];\n        b = b[sort.key];\n\n        if (a === b) {\n          return 0;\n        }\n\n        if (a > b) {\n          return 1 * sort.order;\n        }\n\n        if (a < b) {\n          return -1 * sort.order;\n        }\n      });\n    }\n\n    return _sortedMovies;\n  }, [filterQuery, sort, year]);\n\n  const handleFilter = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setFilterQuery({ ...filterQuery,\n      [name]: value\n    });\n  };\n\n  const handleSort = key => {\n    if (sort.key === key) {\n      setSort({ ...sort,\n        order: -sort.order\n      });\n    } else {\n      setSort({\n        key: key,\n        order: 1\n      });\n    }\n  };\n\n  const handleChange = event => {\n    setYear(event.target.value);\n  };\n\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"header\",\n    id: \"header\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"header-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"logo\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76\n    },\n    __self: this\n  }, React.createElement(\"a\", {\n    href: \"\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77\n    },\n    __self: this\n  }, React.createElement(\"img\", {\n    src: logo,\n    alt: \"logo\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77\n    },\n    __self: this\n  }))), React.createElement(\"div\", {\n    className: \"header-link\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79\n    },\n    __self: this\n  }, React.createElement(\"a\", {\n    href: \"\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80\n    },\n    __self: this\n  }, \"year\")), React.createElement(\"div\", {\n    className: \"header-link\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82\n    },\n    __self: this\n  }, React.createElement(\"a\", {\n    href: \"\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83\n    },\n    __self: this\n  }, \"all\")))), React.createElement(\"div\", {\n    className: \"function\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"function-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"filter\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89\n    },\n    __self: this\n  }, React.createElement(Filter, {\n    handleFilter: handleFilter,\n    filterQuery: filterQuery,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"select function-items\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95\n    },\n    __self: this\n  }, React.createElement(Select, {\n    year: year,\n    handleChange: handleChange,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"button function-items\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101\n    },\n    __self: this\n  }, React.createElement(Button, {\n    button: \"income\",\n    sort: sort,\n    handleSort: handleSort,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"header-link function-items\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108\n    },\n    __self: this\n  }, React.createElement(\"a\", {\n    href: \"#header\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109\n    },\n    __self: this\n  }, React.createElement(\"img\", {\n    src: arrow,\n    alt: \"arrow\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109\n    },\n    __self: this\n  }))))), React.createElement(\"div\", {\n    className: \"main\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"movielist\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114\n    },\n    __self: this\n  }, React.createElement(Movie, {\n    movies: sortedMovies,\n    max: props.movies[year][\"max\"],\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115\n    },\n    __self: this\n  }))), React.createElement(\"div\", {\n    className: \"footer\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121\n    },\n    __self: this\n  }));\n};\n\nexport default Sort;","map":{"version":3,"sources":["/Users/tkak/sample/react2/my-app/src/components/sort.js"],"names":["React","useState","useMemo","Movie","Button","Filter","Select","logo","arrow","Sort","props","sort","setSort","filterQuery","setFilterQuery","year","setYear","sortedMovies","_sortedMovies","movies","filterTitle","title","toLowerCase","filter","row","String","indexOf","key","a","b","order","handleFilter","e","name","value","target","handleSort","handleChange","event"],"mappings":"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","sourcesContent":["import React, { useState, useMemo } from 'react';\nimport Movie from './movie';\nimport Button from './button';\nimport Filter from './filter';\nimport Select from './select';\nimport logo from '../images/logo.png';\nimport arrow from '../images/arrow.png';\n\nconst Sort = (props) => {\n  const [sort, setSort] = useState([])\n  const [filterQuery, setFilterQuery] = useState({});\n  const [year, setYear] = useState([2019]);\n\n  const sortedMovies = useMemo(() => {\n    let _sortedMovies = props.movies[year][\"movies\"];\n\n    //入力した文字は小文字にする\n    const filterTitle = filterQuery.title && filterQuery.title.toLowerCase();\n\n    //絞り込み検索\n    _sortedMovies = _sortedMovies.filter(row => {\n      //タイトルで絞り込み\n      if (\n        filterQuery.title &&\n        String(row.title).toLowerCase().indexOf(filterTitle) === -1\n      ) {\n        return false;\n      }\n      return row;\n    });\n\n    //ソート\n    if (sort.key) {\n      _sortedMovies = _sortedMovies.sort((a, b) => {\n        a = a[sort.key];\n        b = b[sort.key];\n\n        if(a === b) {\n          return 0;\n        }\n        if(a > b) {\n          return 1 * sort.order;\n        }\n        if(a < b) {\n          return -1 * sort.order;\n        }\n      });\n    }\n    return _sortedMovies;\n  }, [filterQuery, sort, year]);\n\n  const handleFilter = e => {\n    const { name, value } = e.target;\n    setFilterQuery({...filterQuery, [name]: value });\n  };\n\n  const handleSort = (key) => {\n    if (sort.key === key) {\n      setSort({...sort, order: -sort.order });\n    } else {\n      setSort({\n        key: key,\n        order: 1\n      })\n    }\n  };\n\n  const handleChange = (event) => {\n    setYear(event.target.value);\n  }\n\n   return(\n    <div>\n      <div className=\"header\" id=\"header\">\n        <div className=\"header-group\">\n          <div className=\"logo\">\n            <a href=\"\"><img src={logo} alt=\"logo\" /></a>\n          </div>\n          <div className=\"header-link\">\n            <a href=\"\">year</a>\n          </div>\n          <div className=\"header-link\">\n            <a href=\"\">all</a>\n          </div>\n        </div>\n      </div>\n      <div className=\"function\">\n        <div className=\"function-group\">\n          <div className=\"filter\">\n            <Filter\n              handleFilter={handleFilter}\n              filterQuery={filterQuery}\n            />\n          </div>\n          <div className=\"select function-items\">\n            <Select\n              year={year}\n              handleChange={handleChange}\n            />\n          </div>\n          <div className=\"button function-items\">\n            <Button\n              button={\"income\"}\n              sort={sort}\n              handleSort={handleSort}\n            />\n          </div>\n          <div className=\"header-link function-items\">\n            <a href=\"#header\"><img src={arrow} alt=\"arrow\" /></a>\n          </div>\n        </div>\n      </div>\n      <div className=\"main\">\n        <div className=\"movielist\">\n          <Movie\n            movies={sortedMovies}\n            max={props.movies[year][\"max\"]}\n          />\n        </div>\n      </div>\n      <div className=\"footer\">\n      </div>\n    </div>\n\n   );\n}\n\nexport default Sort;\n\n"]},"metadata":{},"sourceType":"module"}